<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel Moderno - Sistema de Gesti√≥n de Usuarios</title> 
    
    
<script src="https://cdn.tailwindcss.com"></script>
    
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        /* Necesito mantener estas clases esenciales para el control de vistas y el overlay. */
        .vista-contenido {
            display: none;
        }
        .sidebar-open-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5); 
            z-index: 40; /* Subo el z-index para que est√© por encima de casi todo. */
            display: none;
        }
        /* Aplico la fuente Inter para un look moderno y limpio. */
        body {
            font-family: 'Inter', sans-serif;
        }

        /* Ajustes menores para el scrollbar, para una est√©tica m√°s pulcra. */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #e0e0e0;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #909090;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #707070;
        }
        .dark ::-webkit-scrollbar-track {
            background: #2a2a2a;
        }
        .dark ::-webkit-scrollbar-thumb {
            background: #555;
        }
        .dark ::-webkit-scrollbar-thumb:hover {
            background: #777;
        }

    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 transition-colors duration-300 antialiased"> 
    
<div id="sidebar-overlay" class="sidebar-open-overlay"></div>

    <div class="flex h-screen"> 
        
<aside id="sidebar" 
                class="w-64 bg-gray-800 dark:bg-gray-950 text-white flex-shrink-0 
                     fixed inset-y-0 left-0 transform -translate-x-full lg:translate-x-0 
                     lg:relative z-50 transition-transform duration-300 ease-in-out 
                     shadow-xl lg:shadow-md">
            
            <div class="p-6 text-3xl font-extrabold text-indigo-400 dark:text-indigo-300 border-b border-gray-700/50 dark:border-gray-800">
                <span class="block">ADMIN</span>
                <span class="block text-sm font-light tracking-widest text-gray-400 dark:text-gray-500 mt-1">Panel de Control</span>
            </div>

            <nav class="mt-4 p-4 space-y-2">
                
                <a href="#" data-target="vista-crear" class="menu-item flex items-center p-3 rounded-lg text-gray-300 hover:bg-indigo-600/50 hover:text-white transition duration-200">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg>
                    <span>1. Crear usuarios</span>
                </a>
                <a href="#" data-target="vista-listar" class="menu-item flex items-center p-3 rounded-lg text-gray-300 hover:bg-indigo-600/50 hover:text-white transition duration-200">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16"></path></svg>
                    <span>2. Listado de usuarios</span>
                </a>
                <a href="#" data-target="vista-buscar" class="menu-item flex items-center p-3 rounded-lg text-gray-300 hover:bg-indigo-600/50 hover:text-white transition duration-200">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                    <span>3. Buscar usuarios</span>
                </a>
                <a href="#" data-target="vista-proyectos" class="menu-item flex items-center p-3 rounded-lg text-gray-300 hover:bg-indigo-600/50 hover:text-white transition duration-200">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"></path></svg>
                    <span>4. Gestionar proyectos</span>
                </a>
            </nav>
        </aside>

        <div class="flex-1 flex flex-col overflow-hidden">

            <header class="flex items-center justify-between p-4 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 shadow-sm z-30 sticky top-0">
                <button id="sidebar-toggle" class="lg:hidden text-gray-600 dark:text-gray-300 focus:outline-none p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
                </button>
                <h1 id="current-title" class="text-xl font-semibold text-gray-800 dark:text-white ml-4 lg:ml-0">
                    Vista Actual
                </h1>
                
                <div class="flex items-center space-x-4">
                    <span id="user-greeting" class="text-gray-600 dark:text-gray-400 text-sm md:text-base font-medium bg-gray-100 dark:bg-gray-700 px-3 py-1 rounded-full">
                        Cargando...
                    </span>
                    
                    <a href="#" id="logout-link" 
                       class="flex items-center text-sm font-medium text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 transition duration-150 p-2 rounded-md hover:bg-red-100 dark:hover:bg-red-900/50">
                        <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path></svg>
                        Cerrar sesi√≥n
                    </a>
                </div>
            </header>

            <main class="flex-1 overflow-x-hidden overflow-y-auto p-4 md:p-8">

                <div id="vista-crear" class="vista-contenido bg-white dark:bg-gray-800 p-6 md:p-8 rounded-xl shadow-lg">
                    <h2 class="text-2xl font-bold mb-6 text-gray-800 dark:text-white border-b pb-2 dark:border-gray-700">Crear Nuevo Usuario</h2>
                    <form id="form-crear-usuario">
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                            
                            <div class="lg:col-span-2 p-5 border border-gray-100 dark:border-gray-700 rounded-xl bg-gray-50 dark:bg-gray-700/50 shadow-inner">
                                <p class="font-semibold text-indigo-600 dark:text-indigo-400 mb-4">Informaci√≥n Personal</p>
                                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                    <div>
                                        <label for="id_c" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">1. Identificaci√≥n</label>
                                        <input type="text" id="id_c" name="identificacion" required
                                                     class="mt-1 block w-full border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm p-3 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-800 dark:text-white placeholder-gray-400">
                                    </div>
                                    <div>
                                        <label for="nombres_c" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">2. Nombres</label>
                                        <input type="text" id="nombres_c" name="nombres" required
                                                     class="mt-1 block w-full border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm p-3 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-800 dark:text-white placeholder-gray-400">
                                    </div>
                                    <div>
                                        <label for="apellidos_c" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">3. Apellidos</label>
                                        <input type="text" id="apellidos_c" name="apellidos" required
                                                     class="mt-1 block w-full border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm p-3 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-800 dark:text-white placeholder-gray-400">
                                    </div>
                                    <div>
                                        <label for="fecha_nacimiento_c" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">4. Fecha de nacimiento</label>
                                        <input type="date" id="fecha_nacimiento_c" name="fecha_nacimiento" required
                                                     class="mt-1 block w-full border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm p-3 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-800 dark:text-white placeholder-gray-400">
                                    </div>
                                </div>
                            </div>
                            
                            <div class="p-5 border border-gray-100 dark:border-gray-700 rounded-xl bg-gray-50 dark:bg-gray-700/50 shadow-inner">
                                <p class="font-semibold text-teal-600 dark:text-teal-400 mb-4">Informaci√≥n Adicional</p>
                                <div>
                                    <label for="genero_c" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">5. G√©nero</label>
                                    <select id="genero_c" name="genero" required
                                             class="mt-1 block w-full border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm p-3 focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-800 dark:text-white">
                                        <option value="">Seleccione una opci√≥n</option>
                                        <option value="Masculino">Masculino</option>
                                        <option value="Femenino">Femenino</option>
                                        <option value="Otro">Otro</option>
                                    </select>
                                </div>
                                <div class="mt-4">
                                    <label for="email_c" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">6. Email</label>
                                    <input type="email" id="email_c" name="email" required
                                             class="mt-1 block w-full border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm p-3 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-800 dark:text-white placeholder-gray-400" placeholder="ejemplo@dominio.com">
                                </div>
                            </div>
                        </div>
                        
                        <div class="pt-4 border-t border-gray-200 dark:border-gray-700 flex justify-end">
                            <button type="submit" 
                                     class="inline-flex items-center py-3 px-8 border border-transparent rounded-full shadow-lg text-base font-semibold text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-4 focus:ring-offset-2 focus:ring-indigo-500 transition duration-150 transform hover:scale-105">
                                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                Guardar Usuario
                            </button>
                        </div>
                    </form>
                </div>

                <div id="vista-listar" class="vista-contenido bg-white dark:bg-gray-800 p-6 md:p-8 rounded-xl shadow-lg">
                    <h2 class="text-2xl font-bold mb-6 text-gray-800 dark:text-white border-b pb-2 dark:border-gray-700">Listado de Usuarios</h2>
                    <div class="overflow-x-auto border border-gray-200 dark:border-gray-700 rounded-lg">
                        <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                            <thead class="bg-indigo-50 dark:bg-gray-700 border-b-2 border-indigo-200 dark:border-gray-600">
                                <tr>
                                    <th scope="col" class="px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider">ID Interno</th>
                                    <th scope="col" class="px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider">Identificaci√≥n</th>
                                    <th scope="col" class="px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider">Nombres</th>
                                    <th scope="col" class="px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider">Apellidos</th>
                                    <th scope="col" class="px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider">Nacimiento</th>
                                    <th scope="col" class="px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider">Email</th>
                                    <th scope="col" class="relative px-6 py-4"><span class="sr-only">Acciones</span></th>
                                </tr>
                            </thead>
                            <tbody id="tbody-listar" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                </tbody>
                        </table>
                    </div>
                    <div class="mt-6 flex justify-between items-center bg-gray-50 dark:bg-gray-700/50 p-3 rounded-lg border dark:border-gray-700">
                        <p id="listar-count" class="text-sm font-medium text-gray-700 dark:text-gray-300">Usuarios cargados: 0</p>
                    </div>
                </div>

                <div id="vista-buscar" class="vista-contenido bg-white dark:bg-gray-800 p-6 md:p-8 rounded-xl shadow-lg">
                    <h2 class="text-2xl font-bold mb-6 text-gray-800 dark:text-white border-b pb-2 dark:border-gray-700">Buscar Usuarios</h2>
                    
                    <form id="form-buscar-usuario" class="flex flex-col sm:flex-row gap-4 mb-8 p-4 border border-gray-200 dark:border-gray-700 rounded-xl bg-indigo-50/50 dark:bg-gray-700 shadow-inner">
                        <div class="flex-1">
                            <input type="text" id="search-text" name="search-text" placeholder="Escribe el t√©rmino de b√∫squeda..."
                                class="block w-full border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm p-3 focus:ring-green-500 focus:border-green-500 dark:bg-gray-800 dark:text-white">
                        </div>
                        <div>
                            <select id="search-criterio" name="search-criterio"
                                     class="block w-full sm:w-auto border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm p-3 focus:ring-green-500 focus:border-green-500 bg-white dark:bg-gray-800 dark:text-white">
                                <option value="nombres">Buscar por: Nombres</option>
                                <option value="apellidos">Buscar por: Apellidos</option>
                                <option value="identificacion">Buscar por: Identificaci√≥n</option>
                                <option value="email">Buscar por: Email</option>
                            </select>
                        </div>
                        <div>
                            <button type="submit" 
                                     class="w-full sm:w-auto inline-flex justify-center items-center py-3 px-6 border border-transparent rounded-lg shadow-md text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition duration-150 transform hover:scale-105">
                                <svg class="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                                Buscar
                            </button>
                        </div>
                    </form>

                    <div class="overflow-x-auto border border-gray-200 dark:border-gray-700 rounded-lg">
                        <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                            <thead class="bg-indigo-50 dark:bg-gray-700 border-b-2 border-indigo-200 dark:border-gray-600"> 
                                <tr>
                                    <th scope="col" class="px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider">ID Interno</th>
                                    <th scope="col" class="px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider">Identificaci√≥n</th>
                                    <th scope="col" class="px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider">Nombres</th>
                                    <th scope="col" class="px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider">Apellidos</th>
                                    <th scope="col" class="px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider">Nacimiento</th>
                                    <th scope="col" class="px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider">Email</th>
                                    <th scope="col" class="relative px-6 py-4"><span class="sr-only">Acciones</span></th>
                                </tr>
                            </thead>
                            <tbody id="tbody-buscar" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                </tbody>
                        </table>
                    </div>
                </div>

                <div id="vista-proyectos" class="vista-contenido p-6 md:p-8 rounded-xl shadow-lg bg-white dark:bg-gray-800">
                    <h2 class="text-2xl font-bold mb-8 text-gray-800 dark:text-white border-b pb-2 dark:border-gray-700">
                        Proyectos de Inter√©s UNICOR
                    </h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                        
                        <div class="border border-indigo-200 dark:border-indigo-900 rounded-xl p-6 shadow-xl hover:shadow-2xl transition duration-300 bg-indigo-50/50 dark:bg-gray-700/50 transform hover:-translate-y-1">
                            <div class="flex items-center mb-3">
                                <span class="text-3xl text-indigo-600 dark:text-indigo-400 mr-3">üöÄ</span>
                                <h3 class="text-xl font-bold text-indigo-700 dark:text-indigo-300">
                                    Optimizaci√≥n Log√≠stica Sinuana
                                </h3>
                            </div>
                            <p class="text-gray-600 dark:text-gray-300 text-sm mb-4 border-l-2 border-indigo-400 pl-3">
                                Desarrollo de un sistema de gesti√≥n y simulaci√≥n para mejorar la cadena de suministro en el departamento de C√≥rdoba.
                            </p>
                            <div class="flex justify-between items-center text-sm mb-4">
                                <span class="bg-indigo-600 text-white text-xs font-medium px-3 py-1 rounded-full shadow-md">
                                    Fase I - Ingenier√≠a
                                </span>
                                <span class="text-gray-500 dark:text-gray-400 text-xs font-semibold">
                                    L√≠mite: 2026-06-30
                                </span>
                            </div>
                            <button class="mt-4 w-full bg-indigo-600 text-white py-3 rounded-lg font-semibold hover:bg-indigo-700 transition shadow-lg hover:shadow-xl">
                                Ver Documentaci√≥n
                            </button>
                        </div>

                        <div class="border border-green-200 dark:border-green-900 rounded-xl p-6 shadow-xl hover:shadow-2xl transition duration-300 bg-green-50/50 dark:bg-gray-700/50 transform hover:-translate-y-1">
                            <div class="flex items-center mb-3">
                                <span class="text-3xl text-green-600 dark:text-green-400 mr-3">üî¨</span>
                                <h3 class="text-xl font-bold text-green-700 dark:text-green-300">
                                    Sanidad Animal Regional
                                </h3>
                            </div>
                            <p class="text-gray-600 dark:text-gray-300 text-sm mb-4 border-l-2 border-green-400 pl-3">
                                Estudio epidemiol√≥gico sobre las principales enfermedades que afectan al ganado bovino en el √°rea del Sin√∫ Medio.
                            </p>
                            <div class="flex justify-between items-center text-sm mb-4">
                                <span class="bg-green-600 text-white text-xs font-medium px-3 py-1 rounded-full shadow-md">
                                    Completado (Art√≠culos)
                                </span>
                                <span class="text-gray-500 dark:text-gray-400 text-xs font-semibold">
                                    Finalizado: 2025-11-15
                                </span>
                            </div>
                            <button class="mt-4 w-full bg-green-600 text-white py-3 rounded-lg font-semibold hover:bg-green-700 transition shadow-lg hover:shadow-xl">
                                Ver Publicaci√≥n
                            </button>
                        </div>

                        <div class="border border-yellow-200 dark:border-yellow-900 rounded-xl p-6 shadow-xl hover:shadow-2xl transition duration-300 bg-yellow-50/50 dark:bg-gray-700/50 transform hover:-translate-y-1">
                            <div class="flex items-center mb-3">
                                <span class="text-3xl text-yellow-600 dark:text-yellow-400 mr-3">üíß</span>
                                <h3 class="text-xl font-bold text-yellow-700 dark:text-yellow-300">
                                    Recursos H√≠dricos
                                </h3>
                            </div>
                            <p class="text-gray-600 dark:text-gray-300 text-sm mb-4 border-l-2 border-yellow-400 pl-3">
                                An√°lisis de calidad del agua y mapas de riesgo en la cuenca del R√≠o Sin√∫ en colaboraci√≥n con Geograf√≠a y Biolog√≠a.
                            </p>
                            <div class="flex justify-between items-center text-sm mb-4">
                                <span class="bg-yellow-600 text-white text-xs font-medium px-3 py-1 rounded-full shadow-md">
                                    En Ejecuci√≥n
                                </span>
                                <span class="text-gray-500 dark:text-gray-400 text-xs font-semibold">
                                    Pr√≥ximo Reporte: 2026-03-01
                                </span>
                            </div>
                            <button class="mt-4 w-full bg-yellow-600 text-white py-3 rounded-lg font-semibold hover:bg-yellow-700 transition shadow-lg hover:shadow-xl">
                                Ver Panel de Control
                            </button>
                        </div>
                    </div>
                    
                </main>

                <footer class="bg-white dark:bg-gray-800 p-4 border-t border-gray-300 dark:border-gray-700 flex justify-center items-center flex-shrink-0">
                    <p class="text-sm text-gray-600 dark:text-gray-400 font-medium">
                        ¬© 2025 Todos los derechos reservados al 
                        <span class="font-bold text-indigo-600 dark:text-indigo-400">Ing. Cristian Diaz N.</span>
                    </p>
                </footer>
            </div>
            
        </div>
        <script>
        
        // --- 1. L√ìGICA DE LOCALSTORAGE (Memoria del navegador) ---
        
        function getUsuarios() {
            // Necesito obtener la lista de usuarios guardada. Si no existe, devuelvo un array vac√≠o.
            const usuarios = localStorage.getItem('usuarios');
            return usuarios ? JSON.parse(usuarios) : [];
        }

        function saveUsuarios(usuarios) {
            // Guardo la lista actualizada de vuelta en el navegador.
            localStorage.setItem('usuarios', JSON.stringify(usuarios));
        }
        
        // --- 2. L√ìGICA DE VISTAS Y SIDEBAR ---

        const menuItems = document.querySelectorAll('.menu-item');
        const vistas = document.querySelectorAll('.vista-contenido');
        const currentTitle = document.getElementById('current-title');
        const tbodyListar = document.getElementById('tbody-listar');
        const tbodyBuscar = document.getElementById('tbody-buscar');
        const listarCount = document.getElementById('listar-count');
        const sidebar = document.getElementById('sidebar');
        const sidebarOverlay = document.getElementById('sidebar-overlay');


        function showView(targetId) {
            // Primero, oculto todas las vistas.
            vistas.forEach(vista => vista.style.display = 'none');
            const targetView = document.getElementById(targetId);
            if (targetView) {
                // Luego, muestro solo la vista que me interesa y actualizo el t√≠tulo.
                targetView.style.display = 'block';
                const menuItem = document.querySelector(`.menu-item[data-target="${targetId}"]`);
                if (menuItem) {
                    currentTitle.textContent = 'Vista Actual: ' + menuItem.textContent.trim().substring(3).trim();
                }
            }
            
            // Si estoy en m√≥vil y hago clic en un men√∫, deber√≠a cerrarse la barra lateral autom√°ticamente.
            if (!sidebar.classList.contains('lg:translate-x-0') && sidebar.classList.contains('-translate-x-full')) {
                 toggleSidebar(false);
            }
        }
        
        function toggleSidebar(show) {
            // Esto controla si el sidebar entra o sale de la pantalla en m√≥vil.
            if (show) {
                sidebar.classList.remove('-translate-x-full');
                sidebar.classList.add('translate-x-0');
                sidebarOverlay.style.display = 'block';
            } else {
                sidebar.classList.remove('translate-x-0');
                sidebar.classList.add('-translate-x-full');
                sidebarOverlay.style.display = 'none';
            }
        }
        

        document.getElementById('sidebar-toggle').addEventListener('click', function() {
            // Si el bot√≥n de men√∫ es presionado, alterno el estado de la barra lateral.
            const isHidden = sidebar.classList.contains('-translate-x-full');
            toggleSidebar(isHidden);
        });

        sidebarOverlay.addEventListener('click', () => {
             // Si el usuario toca el fondo oscuro (overlay), cierro el sidebar.
             toggleSidebar(false);
        });


        // --- 3. L√ìGICA DE BIENVENIDA PERSONALIZADA ---
        function displayWelcomeMessage() {
            // Verifico si tengo el nombre del usuario logeado; si no, lo mando al login.
            const greetingElement = document.getElementById('user-greeting');
            const userName = localStorage.getItem('userNombre'); 
            
            if (userName && greetingElement) {
                greetingElement.textContent = `Admin. ${userName.replace("Ing. ", "")}`; 
            } else if (greetingElement) {
                // ‚≠ê CAMBIO 1: Redirigir a "index.html" (el nuevo nombre del login)
                window.location.replace("index.html"); 
            }
        }
        
        // --- 4. FUNCI√ìN PARA ELIMINAR USUARIO ---
        function deleteUser(userId) {
            // Primero, pido confirmaci√≥n para evitar errores accidentales.
            if (!confirm(`¬øEst√°s seguro de que deseas eliminar el usuario con ID ${userId}? Esta acci√≥n no se puede deshacer.`)) {
                return;
            }

            let usuarios = getUsuarios();
            // Filtro para quedarme con todos los usuarios EXCEPTO el que tiene el ID que quiero eliminar.
            const nuevosUsuarios = usuarios.filter(user => user.id !== userId);

            if (nuevosUsuarios.length < usuarios.length) {
                saveUsuarios(nuevosUsuarios);
                alert(`Usuario con ID ${userId} eliminado correctamente.`);

                // Las tablas deben reflejar el cambio inmediatamente.
                renderizarTabla(nuevosUsuarios, tbodyListar);
                
                // Tambi√©n actualizo la tabla de b√∫squeda, manteniendo el filtro si lo hab√≠a.
                const currentSearchText = document.getElementById('search-text').value.toLowerCase();
                const criterio = document.getElementById('search-criterio').value;
                
                if (currentSearchText) { 
                    const resultados = nuevosUsuarios.filter(user => String(user[criterio]).toLowerCase().includes(currentSearchText));
                    renderizarTabla(resultados, tbodyBuscar);
                } else {
                    renderizarTabla(nuevosUsuarios, tbodyBuscar); 
                }

            } else {
                alert(`Error: No se encontr√≥ un usuario con ID ${userId}.`);
            }
        }


        // --- 5. FUNCI√ìN PARA DIBUJAR LA TABLA (LISTAR Y BUSCAR) ---
        
        function renderizarTabla(usuarios, tbodyElement) {
            // Vac√≠o el cuerpo de la tabla para empezar desde cero.
            tbodyElement.innerHTML = ''; 
            
            if (usuarios.length === 0) {
                // Si no hay datos, muestro un mensaje amigable.
                const colSpan = 7; // El n√∫mero de columnas de la tabla.
                const row = tbodyElement.insertRow();
                const cell = row.insertCell();
                cell.colSpan = colSpan;
                cell.classList.add('py-4', 'text-center', 'text-sm', 'text-gray-500', 'dark:text-gray-400', 'italic');
                cell.textContent = "No se encontraron usuarios registrados.";
                
                // Actualizo el contador si es la tabla principal
                if (tbodyElement.id === 'tbody-listar') {
                    listarCount.textContent = `Usuarios cargados: 0`;
                }

                return;
            }

            // Mapeo los datos a filas de la tabla
            usuarios.forEach(user => {
                const row = tbodyElement.insertRow();
                row.classList.add('hover:bg-gray-50', 'dark:hover:bg-gray-700/70', 'transition-colors', 'duration-150');

                // ID Interno (Oculto o para referencia)
                let cell = row.insertCell();
                cell.classList.add('px-6', 'py-3', 'text-sm', 'font-medium', 'text-gray-500', 'dark:text-gray-400');
                cell.textContent = user.id;

                // Identificaci√≥n
                cell = row.insertCell();
                cell.classList.add('px-6', 'py-3', 'text-sm', 'font-medium', 'text-gray-900', 'dark:text-white');
                cell.textContent = user.identificacion;

                // Nombres
                cell = row.insertCell();
                cell.classList.add('px-6', 'py-3', 'text-sm', 'text-gray-600', 'dark:text-gray-300');
                cell.textContent = user.nombres;

                // Apellidos
                cell = row.insertCell();
                cell.classList.add('px-6', 'py-3', 'text-sm', 'text-gray-600', 'dark:text-gray-300');
                cell.textContent = user.apellidos;

                // Fecha de Nacimiento
                cell = row.insertCell();
                cell.classList.add('px-6', 'py-3', 'text-sm', 'text-gray-600', 'dark:text-gray-300');
                cell.textContent = user.fecha_nacimiento; 

                // Email
                cell = row.insertCell();
                cell.classList.add('px-6', 'py-3', 'text-sm', 'text-indigo-600', 'dark:text-indigo-400', 'truncate');
                cell.textContent = user.email;

                // Acciones (Bot√≥n Eliminar)
                cell = row.insertCell();
                cell.classList.add('px-6', 'py-3', 'whitespace-nowrap', 'text-right', 'text-sm', 'font-medium');
                
                // Creo el bot√≥n de eliminar y le asigno la funci√≥n deleteUser
                const deleteButton = document.createElement('button');
                deleteButton.textContent = 'Eliminar';
                deleteButton.classList.add('text-red-600', 'hover:text-red-900', 'dark:text-red-400', 'dark:hover:text-red-200', 'font-semibold', 'transition-colors', 'duration-150', 'p-2', 'rounded-md', 'hover:bg-red-50', 'dark:hover:bg-red-900/50');
                deleteButton.onclick = () => deleteUser(user.id);
                cell.appendChild(deleteButton);
            });
            
            // Actualizo el contador si es la tabla principal
            if (tbodyElement.id === 'tbody-listar') {
                listarCount.textContent = `Usuarios cargados: ${usuarios.length}`;
            }

        }


        // --- 6. ASIGNACI√ìN DE LISTENERS AL C√ìDIGO ---

        menuItems.forEach(item => {
            item.addEventListener('click', function(e) {
                e.preventDefault();
                // Desmarco todos los √≠tems y marco el activo
                menuItems.forEach(i => i.classList.remove('bg-indigo-700', 'text-white'));
                this.classList.add('bg-indigo-700', 'text-white');

                const targetId = this.getAttribute('data-target');
                showView(targetId);
                
                // Si la vista es 'vista-listar', fuerzo la actualizaci√≥n de la tabla.
                if (targetId === 'vista-listar') {
                    renderizarTabla(getUsuarios(), tbodyListar);
                }
            });
        });

        // Inicializo la primera vista y marco el primer √≠tem del men√∫.
        document.addEventListener('DOMContentLoaded', () => {
            const initialViewId = 'vista-crear'; // Vista inicial por defecto
            showView(initialViewId); 
            const firstMenuItem = document.querySelector(`.menu-item[data-target="${initialViewId}"]`);
            if (firstMenuItem) {
                 firstMenuItem.classList.add('bg-indigo-700', 'text-white');
            }
            // Muestro el mensaje de bienvenida y redirijo si no hay sesi√≥n.
            displayWelcomeMessage(); 
            
            // Inicializo la tabla listar al cargar por primera vez
            renderizarTabla(getUsuarios(), tbodyListar);
        });

        // --- 7. L√ìGICA DE CREAR USUARIO ---
        document.getElementById('form-crear-usuario').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Genero un ID √∫nico (podr√≠a ser un timestamp o un hash)
            const newId = Date.now(); 

            // Construyo el objeto del nuevo usuario
            const newUser = {
                id: newId, // Lo uso como ID interno para operaciones de eliminaci√≥n.
                identificacion: document.getElementById('id_c').value,
                nombres: document.getElementById('nombres_c').value,
                apellidos: document.getElementById('apellidos_c').value,
                fecha_nacimiento: document.getElementById('fecha_nacimiento_c').value,
                genero: document.getElementById('genero_c').value,
                email: document.getElementById('email_c').value,
            };

            // Obtengo la lista actual, agrego el nuevo usuario y guardo.
            let usuarios = getUsuarios();
            usuarios.push(newUser);
            saveUsuarios(usuarios);

            alert(`‚úÖ Usuario ${newUser.nombres} ${newUser.apellidos} guardado con √©xito! ID: ${newUser.id}`);

            // Limpio el formulario despu√©s de guardar
            this.reset();
            
            // Opcional: Redirigir a la vista de Listado de Usuarios
            showView('vista-listar');
            renderizarTabla(getUsuarios(), tbodyListar);
            
            // Desmarco el men√∫ de Crear y marco el de Listar
            menuItems.forEach(i => i.classList.remove('bg-indigo-700', 'text-white'));
            const listarMenuItem = document.querySelector(`.menu-item[data-target="vista-listar"]`);
            if (listarMenuItem) {
                listarMenuItem.classList.add('bg-indigo-700', 'text-white');
            }
        });
        
        // --- 8. L√ìGICA DE CERRAR SESI√ìN ---
        const logoutLink = document.getElementById('logout-link');
        if (logoutLink) {
            // Limpio la variable de sesi√≥n y redirijo al nuevo archivo de inicio.
            logoutLink.addEventListener('click', (e) => {
                e.preventDefault(); 
                localStorage.removeItem('userNombre'); 
                // ‚≠ê CAMBIO 2: Redirigir a "index.html" (el nuevo nombre del login)
                window.location.replace("index.html");
            });
        }
        
        // --- 9. L√ìGICA DE BUSCAR USUARIO ---
        document.getElementById('form-buscar-usuario').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const searchText = document.getElementById('search-text').value.toLowerCase();
            const criterio = document.getElementById('search-criterio').value;
            const usuarios = getUsuarios();
            
            // Si el campo de b√∫squeda est√° vac√≠o, simplemente muestro todos los usuarios en la tabla de b√∫squeda.
            if (searchText.trim() === "") {
                renderizarTabla(usuarios, tbodyBuscar);
                return;
            }

            // Realizo el filtrado: comparo el valor del criterio seleccionado (identificacion, nombres, etc.) con el texto de b√∫squeda.
            const resultados = usuarios.filter(user => 
                String(user[criterio]).toLowerCase().includes(searchText)
            );

            // Muestro los resultados en la tabla de la vista "vista-buscar"
            renderizarTabla(resultados, tbodyBuscar);
        });

    </script>
</body>
</html>
